import numpy
from numpy import linalg as LA

# [15, 30]
cps=numpy.array([[ 3.90307433e-01,  2.85452251e-02, -9.00552323e-03,
        -8.57435387e-03,  4.83720856e-02, -6.07224179e-02,
         3.89159962e-01,  1.03143388e-03,  2.89252541e-02,
         1.12813005e-01,  2.31642524e-02, -6.88951797e-03,
        -2.18514586e-03, -5.02549783e-02, -7.22779131e-03,
        -4.79574297e-02,  6.31317898e-02, -1.58911061e-02,
         3.62441906e-02,  9.94098833e-02,  4.94557675e-01,
        -6.04290185e-02,  3.22035280e-02, -5.60223492e-03,
        -8.37403709e-03, -3.80887293e-01, -1.76244258e-02,
         5.08023437e-01,  3.72453064e-02, -2.26855416e-02],
       [ 3.78115225e-01, -3.54341450e-02, -1.35282951e-01,
        -3.38358355e-02,  2.54308592e-01,  1.57746829e-01,
         3.87728933e-01,  1.26450921e-04, -3.38457203e-02,
         4.35434599e-01,  2.75880124e-02, -2.79906804e-02,
         3.50831013e-04, -8.65414682e-02,  6.39519237e-03,
         1.45878636e-02,  2.43525783e-01, -1.49489628e-02,
        -1.34115961e-02,  6.49787463e-02, -2.07830700e-01,
         2.46059220e-01,  1.30231456e-02, -1.43382626e-01,
         9.32068571e-03,  4.06729771e-01,  2.48725326e-03,
        -2.02952902e-01, -1.41932145e-02,  3.29975641e-02],
       [-6.46824655e-02,  8.68060586e-02,  2.27056175e-01,
         2.84939520e-02,  3.13361661e-01, -1.34551617e-02,
        -3.34939153e-02,  2.80538381e-03,  8.36827437e-02,
         2.17796820e-01,  8.67760833e-02,  2.37238403e-02,
         7.78142508e-03,  5.61662116e-02,  2.92253845e-03,
         7.33212422e-03,  3.40785998e-01,  1.20898533e-01,
        -7.63560835e-02, -2.57415869e-01, -2.13395696e-01,
         9.42581274e-02, -7.58576902e-02,  2.32494115e-01,
         4.06997362e-03, -5.92801843e-01, -3.19694698e-02,
        -1.92274638e-01, -7.93481159e-02,  2.40429365e-01],
       [ 1.70867682e-01, -9.43382941e-02, -5.18313556e-02,
         2.35438549e-02, -1.32664906e-01, -4.97013109e-02,
         1.73701511e-01, -9.97317704e-03, -9.52765198e-02,
        -1.85730685e-02, -3.75240006e-02,  1.95844103e-02,
        -2.58259553e-03,  6.84893616e-02, -8.44484051e-03,
        -7.75166112e-02, -1.42892952e-01, -3.35084706e-02,
         9.39944076e-02,  5.52574356e-01, -3.65280428e-01,
        -2.65856802e-01,  6.03293023e-02, -5.48893587e-02,
        -1.28043958e-02, -4.13258639e-01,  2.74876858e-02,
        -3.45713321e-01,  9.87707612e-02, -1.97174531e-01],
       [ 2.29619051e-02, -2.27520129e-01,  8.48749027e-02,
        -9.42779425e-03, -4.79455903e-01, -1.03973354e-01,
         1.31970103e-02,  6.66895344e-03, -2.47324363e-01,
         4.58278638e-01, -6.22886505e-02, -5.29696778e-04,
        -8.45466739e-03,  1.49688586e-02,  2.16266957e-02,
         1.12000721e-03, -4.20645357e-01,  2.28455543e-02,
        -6.50520533e-02, -1.60239558e-01,  7.61684169e-02,
         3.66930350e-01,  1.04896398e-01,  9.57277447e-02,
         3.41415788e-02, -1.30555407e-01, -1.81355824e-02,
        -9.66673650e-02, -6.82558886e-02,  1.52158258e-01],
       [-1.10424600e-01,  1.73378656e-01,  3.99362386e-01,
         1.30809038e-01, -8.36567906e-03,  1.81497598e-01,
        -8.97314012e-02,  6.71715069e-03,  1.67780458e-01,
         2.72042659e-01,  6.27135804e-02,  1.09700575e-01,
         5.78893629e-03,  2.13792411e-01,  1.78783767e-02,
         3.74986856e-02, -2.45763713e-02,  1.29215284e-01,
         2.21548199e-01,  4.53527816e-01,  1.03634012e-01,
         6.38859150e-02, -3.41767364e-02,  4.16019562e-01,
         2.18752271e-02,  2.22361975e-01, -2.76751864e-02,
         9.48284122e-02,  2.31375095e-01,  9.79592380e-03],
       [ 1.79320274e-01,  2.47136222e-02,  1.62756388e-02,
        -2.83259247e-02, -1.26406253e-01,  2.60368596e-01,
         1.00082655e-01,  2.57897072e-02,  9.28895088e-03,
        -4.17878256e-01,  1.41996388e-01, -2.62543284e-02,
         2.41386085e-03, -2.87869434e-01, -1.00186623e-02,
         9.83930178e-02, -1.08382162e-01,  2.66851679e-01,
         5.44089361e-03,  1.74570130e-01,  7.51223293e-04,
         9.69492233e-02, -1.26430685e-03,  2.24849991e-02,
        -4.71865721e-03, -7.01760484e-03, -1.24273625e-01,
        -8.99597435e-02,  1.91314534e-02,  6.60420545e-01],
       [ 3.29279596e-01, -1.74040163e-02,  3.52723236e-01,
         5.93699043e-02, -1.07429058e-01, -1.12589700e-01,
         3.43655799e-01, -1.99547520e-02,  6.71795434e-03,
        -2.06750545e-01, -2.78307259e-02,  5.75259734e-02,
         1.44290249e-02,  2.35185455e-01, -6.73436474e-03,
         4.92814819e-02, -1.27875538e-01,  1.26045760e-01,
        -1.20247575e-01, -3.45945644e-01, -1.57429763e-01,
        -3.36127180e-01, -4.04315124e-02,  3.21093742e-01,
        -2.39768100e-02,  2.23502542e-01,  1.75261728e-01,
        -3.89335951e-02, -1.44469171e-01, -5.69064410e-02],
       [-6.78977441e-02, -1.52745632e-01,  6.32268840e-02,
        -1.07339079e-01,  1.26326247e-01, -1.69923916e-01,
        -4.07244506e-02, -1.14621524e-01, -3.09107523e-02,
         1.52459010e-02, -4.68655774e-02, -8.69620817e-02,
         3.85183811e-02, -1.22506588e-01,  3.26172364e-02,
        -5.02352377e-02, -9.48371769e-02,  8.93953926e-02,
         7.04489364e-02,  1.47801016e-01, -3.21185982e-01,
         1.45160680e-01, -2.35878651e-01, -5.66714558e-02,
         4.35251641e-02, -6.01024901e-03,  6.75355305e-01,
         3.93744869e-01,  3.19729194e-03,  1.61020999e-01],
       [-9.05010097e-02, -4.27610208e-01,  2.38689592e-01,
        -1.50354811e-01,  1.61705089e-01, -1.89111035e-01,
        -7.71739381e-02,  5.05152421e-03, -4.50925691e-01,
        -2.11480761e-02,  4.91266335e-02, -1.12504716e-01,
        -2.26074659e-02, -2.78224362e-01, -6.85495459e-02,
        -2.32495948e-01,  2.66713761e-01,  3.17512844e-02,
        -3.60541880e-02,  1.49937555e-01,  1.31089155e-01,
        -1.79523671e-01,  2.40648574e-01,  2.48792821e-01,
        -7.86277462e-02,  1.44578583e-01, -1.05447883e-01,
        -2.05218152e-02, -3.96160977e-02,  2.48652860e-02],
       [ 1.11346882e-01, -3.23908681e-02,  1.01582665e-01,
         6.69365246e-03,  1.70093361e-02, -2.83427542e-01,
         5.41823516e-02, -2.20658110e-02, -1.48884404e-02,
        -4.15188675e-01, -1.33609022e-01,  1.83757763e-02,
         9.30047946e-03,  2.75592684e-01,  7.73699753e-02,
        -9.30725968e-03,  1.52554156e-01, -6.84381677e-02,
        -6.88771154e-02,  1.69011764e-01, -1.55735675e-01,
         6.36145204e-01,  1.16519873e-01,  7.28322519e-02,
         7.36157680e-02, -6.44728815e-03, -2.40462312e-01,
         1.28195188e-01, -9.64582469e-02, -1.45397182e-01],
       [-6.14537328e-02, -3.22747599e-01, -1.96087002e-01,
         1.68549984e-01,  1.46729874e-01,  9.43642235e-04,
        -1.53771783e-02,  1.44150939e-02, -3.42755080e-01,
        -5.58724861e-03,  1.98582329e-02,  1.43254018e-01,
         3.16476164e-02,  5.66223052e-01,  1.29378318e-01,
         3.26770364e-01,  1.04061787e-01,  2.38939965e-01,
         3.88782562e-02,  4.82827072e-02,  1.70932098e-01,
        -1.18258459e-01, -9.75020875e-02, -1.84797664e-01,
         1.18214412e-01,  9.31854219e-03,  3.41150583e-02,
        -4.63994193e-03,  4.54387740e-02,  2.09122558e-01],
       [-5.09467592e-02,  2.30170056e-01, -1.20999064e-01,
        -5.14035998e-03, -3.47873326e-02, -7.73900610e-01,
         3.26245127e-02,  7.68540494e-03,  2.12183147e-01,
         1.75875293e-01, -5.75821491e-02, -1.04627122e-02,
         2.10726571e-02, -3.49907407e-02, -1.47546236e-03,
         1.20759577e-04,  6.94487919e-03,  2.29733144e-01,
         1.07671262e-02,  1.11189796e-01, -2.85497700e-03,
        -1.70497813e-01, -4.96576917e-02, -8.91260275e-02,
        -2.71798754e-02,  1.54941349e-01, -2.08152199e-01,
        -5.40882450e-02,  1.00854738e-02,  2.67510485e-01],
       [ 2.50575590e-02,  1.60584567e-01, -6.64168976e-02,
        -1.07002081e-01, -6.44511081e-03, -9.05159000e-02,
        -5.54735708e-03,  4.01045068e-02,  1.20849990e-01,
        -1.08657892e-01,  1.67625094e-01, -7.51178213e-02,
        -3.66657634e-02,  1.99744193e-01,  8.68405894e-03,
        -2.13914160e-01,  8.55805579e-02,  1.12302306e-01,
         7.35177390e-02, -2.87547028e-02,  3.14187233e-01,
         1.40914388e-01,  4.99087236e-01, -2.95309284e-02,
         1.64461801e-02, -2.83030620e-03,  5.24198208e-01,
        -3.46419236e-01,  9.88413930e-02,  3.29396615e-02],
       [ 6.59209962e-02, -9.77506386e-02,  8.22760200e-04,
        -6.26724814e-02, -5.07084907e-02, -9.65827085e-02,
         5.55805062e-02, -2.03391874e-02, -7.40083404e-02,
        -6.94073469e-02,  2.02687856e-01, -4.82817402e-02,
        -2.57088699e-03, -1.22498625e-02,  8.19218680e-02,
        -7.53532059e-02,  1.52257699e-02, -2.25110032e-02,
         5.89059667e-01, -3.61507453e-01, -2.02479856e-01,
         2.78524349e-02,  2.31660328e-02, -1.75395353e-02,
         7.03912533e-02, -9.21100601e-03, -1.67391229e-01,
         7.69675983e-02,  5.83303679e-01, -1.58669688e-02]])


#对X做PCA降维
def pca_trans(X,n):     # X: [3600, 30]  
    if X.shape[0] != 30:
        X = X.T
    Y = numpy.matmul(cps,X)
    if X.shape[0] != 30:
        Y = Y.T
    return Y[:n]        # [3600, n]

#逆PCA升维
def pca_inv(Y):
    if Y.ndim == 1:
        n = Y.shape[0]
    else:
        n = Y.shape[0]
    X = numpy.matmul(cps[:n].T,Y)
    return X.T